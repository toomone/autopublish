name: Publish newsletter
on: 
  pull_request:
    branches: 
      - master

jobs:
  publish_newsletter:
    runs-on: ubuntu-latest
    if: startsWith(github.event.pull_request.head.ref,'autopublish-')
    steps:
      - name: Get current date
        id: date
        run: echo "::set-output name=date::$(date +'%Y-%m-%d')"

      - name: Display current date
        run: echo "${{ steps.date.outputs.date }}"

      - name: Merge by labeled
        uses: devmasx/merge-branch@v1.3.1
        with:
          label_name: publish_newsletter
          target_branch: master
        env:
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
