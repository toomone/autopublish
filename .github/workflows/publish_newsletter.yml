name: Publish newsletter
on: 
  pull_request:
    branches: [master]
    types: [opened]

jobs:
  publish_newsletter:
    runs-on: ubuntu-latest
    if: startsWith(github.event.pull_request.head.ref,'autopublish-')
    steps:
      - name: Get current date
        id: date
        run: echo "::set-output name=date::$(date +'%Y-%m-%d')"

      - name: Display current date
        run: echo "${{ steps.date.outputs.date }}"

      - name: Automerge
        uses: "pascalgn/automerge-action@v0.14.1"
        env:
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
